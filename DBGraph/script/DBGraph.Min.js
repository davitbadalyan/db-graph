function pageLoaded(){var t=document.getElementById("preload"),a=document.getElementById("content");t.style.display="none",a.style.display="block",pageInit(),scpInit(),getWtrPosition(),window.onload=start,setInterval(function(){drawWaterfall(null)},50)}function pageInit(){var t=document.getElementById("waterfall");t.style.width=wtrWidthSmall+"px",t.style.height=wtrHeightSmall+20+"px",CNV_waterfall=document.createElement("canvas"),CNV_waterfall.setAttribute("id","CanvasWaterfall"),CNV_waterfall.width=wtrWidthSmall,CNV_waterfall.height=wtrHeightSmall,t.appendChild(CNV_waterfall),CNV_ctx_waterfall=CNV_waterfall.getContext("2d"),CNV_waterfallZoom=document.createElement("canvas"),CNV_waterfallZoom.setAttribute("id","CanvasWaterfallZoom"),CNV_waterfallZoom.width=wtrWidthSmall,CNV_waterfallZoom.height=wtrHeightSmall,t.appendChild(CNV_waterfallZoom),CNV_ctx_waterfallZoom=CNV_waterfallZoom.getContext("2d"),CNV_waterfallOrig=document.createElement("canvas"),CNV_waterfallOrig.setAttribute("id","CanvasWaterfallOrig"),CNV_waterfallOrig.width=wtrWidthBig,CNV_waterfallOrig.height=wtrHeightBig,t.appendChild(CNV_waterfallOrig),CNV_ctx_waterfallOrig=CNV_waterfallOrig.getContext("2d"),imgData=CNV_ctx_waterfallOrig.createImageData(wtrWidthBig,1),DIV_waterfallNav=document.createElement("div"),DIV_waterfallNav.setAttribute("id","waterfallNav"),DIV_waterfallNav.style.width=wtrWidthSmall+"px",DIV_waterfallNav.style.height="20px",DIV_waterfallNav.style.borderBottom="1px solid white",DIV_waterfallNav.style.paddingTop="1px",DIV_waterfallNav.style.backgroundColor="#000000",DIV_waterfallNav.style.color="white",wtrZoomOutButton=document.createElement("img"),wtrZoomOutButton.style["float"]="right",wtrZoomOutButton.src="../images/ZoomOff.png",wtrZoomOutButton.style.cursor="pointer",DIV_waterfallNav.appendChild(wtrZoomOutButton),t.appendChild(DIV_waterfallNav),InitMouseEvents()}function drawWaterfall(t){for(t=randomData(wtrWidthBig,0,10,80),drawscope(t),start=window.performance.now(),CNV_ctx_waterfallOrig.drawImage(CNV_waterfallOrig,0,0,wtrWidthBig,wtrHeightBig,0,-1,wtrWidthBig,wtrHeightBig),Zoom||draw==WtrDrawRate?(CNV_ctx_waterfall.clearRect(0,0,wtrWidthSmall,wtrHeightSmall),CNV_ctx_waterfall.drawImage(CNV_waterfallOrig,wtrDisplayOriginX,wtrDisplayOriginY,wtrDisplayWidth,wtrDisplayHeight-1,0,0,wtrWidthSmall,wtrHeightSmall),draw=0):draw++,i=0;i<imgData.data.length;i+=4)RGBVal=waveLengthToRGB(380+interval*t[i/4]),imgData.data[i+0]=RGBVal[0],imgData.data[i+1]=RGBVal[1],imgData.data[i+2]=RGBVal[2],imgData.data[i+3]=255;CNV_ctx_waterfallOrig.putImageData(imgData,0,wtrHeightBig-1),document.getElementById("XVal2").value=window.performance.now()-start}function getWtrPosition(){var t=getOffset(CNV_waterfall);WtrPositionX=t.left,WtrPositionY=t.top}function waveLengthToRGB(t){var a,e,l,r,i=.8,w=255;t>=380&&440>t?(e=0,l=0,r=(t-380)/60):t>=440&&490>t?(e=0,l=(t-440)/50,r=1):t>=490&&510>t?(e=0,l=1,r=-(t-510)/20):t>=510&&580>t?(e=(t-510)/70,l=1,r=0):t>=580&&645>t?(e=1,l=-(t-645)/65,r=0):t>=645&&781>t?(e=1,l=0,r=0):(e=0,l=0,r=0),a=t>=380&&420>t?.3+.7*(t-380)/40:t>=420&&701>t?1:t>=701&&781>t?.3+.7*(780-t)/80:0;var o=[];return o[0]=0==e?0:Math.round(w*Math.pow(e*a,i)),o[1]=0==l?0:Math.round(w*Math.pow(l*a,i)),o[2]=0==r?0:Math.round(w*Math.pow(r*a,i)),o}window.onload=pageLoaded;var waterfallSamples=4096,waterfallLines=1e3,wtrWidthBig=waterfallSamples,wtrHeightBig=waterfallLines,wtrWidthSmall=1800,wtrHeightSmall=350,wtrDisplayOriginX=0,wtrDisplayOriginY=0,wtrDisplayWidth=wtrWidthBig,wtrDisplayHeight=wtrHeightBig,WtrPositionX,WtrPositionY,WtrDrawRate=5,DIV_waterfall,CNV_waterfall,CNV_waterfallOrig,CNV_waterfallZoom,CNV_ctx_waterfall,CNV_ctx_waterfallOrig,CNV_ctx_waterfallZoom,DIV_waterfallNav,wtrZoomOutButton,imgData,draw=0,Zoom=!1,start=window.performance.now(),interval=4;